---
// style import
import "@/styles/starwind.css";
import Navbar from "../components/navbar/navbar.astro";
import LoadingScreen from "@/components/LoadingScreen.astro";

interface Props {
   noindex?: boolean;
   showNav?: boolean;
}

const { noindex = false, showNav = true } = Astro.props;
---

<!doctype html>
<html lang='en'>
   <head>
      <meta charset='UTF-8' />
      <meta name='viewport' content='width=device-width' />
      <link rel='preconnect' href='https://fonts.googleapis.com' />
      <link rel='preconnect' href='https://fonts.gstatic.com' crossorigin />
      <link
         href='https://fonts.googleapis.com/css2?family=Archivo:ital,wght@0,100..900;1,100..900&family=Host+Grotesk:ital,wght@0,300..800;1,300..800&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap'
         rel='stylesheet'
      />
      <link rel='icon' type='image/svg+xml' href='/favicon.svg' />
      <meta name='generator' content={Astro.generator} />
      <meta
         name='description'
         content='LAVA is a global UGC and creator marketing agency helping brands grow through organic campaigns, scalable UGC production and strategic product seeding.'
      />
      <meta name='keywords' content='LAVA, UGC, Agency, Marketing, RRSS' />
      {noindex && <meta name='robots' content='noindex, nofollow' />}
      <title>LAVA UGC Agency | Creator Campaigns & UGC Production</title>
   </head>
   <body>
      <LoadingScreen />
      {showNav && <Navbar />}
      <main class='main-content'>
         <slot />
      </main>
   </body>

   <script>
      import Lenis from "lenis";

      const lenis = new Lenis({ lerp: 0.9 });

      function raf(time: number) {
         lenis.raf(time);
         requestAnimationFrame(raf);
      }

      requestAnimationFrame(raf);
   </script>
   <script>
      import { animate, scroll } from "motion";

      const icons = document.querySelectorAll(".parallax-icon");

      icons.forEach((icon) => {
         const htmlIcon = icon as HTMLElement;

         const width = htmlIcon.offsetWidth;
         const baseSpeed = 70;
         const speed = baseSpeed / width;
         const distance = -150 * speed;

         scroll(
            animate(htmlIcon, {
               y: [0, distance],
            }),
            {
               target: htmlIcon,
               offset: ["start end", "end start"],
            }
         );
      });
   </script>
   <!-- Motion Animations -->
   <script>
      import { animate, scroll } from "motion";

      const easeExpoOut: [number, number, number, number] = [0.16, 1, 0.3, 1];

      // ===================
      // 1. PARALLAX ICONS
      // ===================
      document
         .querySelectorAll<HTMLElement>(".parallax-icon")
         .forEach((icon) => {
            const width = icon.offsetWidth;
            const baseSpeed = 70;
            const speed = baseSpeed / width;
            const distance = -150 * speed;

            scroll(
               animate(icon, {
                  y: [0, distance],
               }),
               {
                  target: icon,
                  offset: ["start end", "end start"],
               }
            );
         });

      // ===================
      // 2. SLIDE UP ON SCROLL
      // ===================
      document
         .querySelectorAll<HTMLElement>("[data-animate='slide-up']")
         .forEach((element) => {
            scroll(
               animate(
                  element,
                  { opacity: [0, 1], y: [30, 0] },
                  { ease: easeExpoOut }
               ),
               {
                  target: element,
                  offset: ["start 0.85", "start 0.4"],
               }
            );
         });

      // ===================
      // 3. FADE IN ON SCROLL
      // ===================
      document
         .querySelectorAll<HTMLElement>("[data-animate='fade-in']")
         .forEach((element) => {
            scroll(
               animate(element, { opacity: [0, 1] }, { ease: easeExpoOut }),
               {
                  target: element,
                  offset: ["start 0.85", "start 0.5"],
               }
            );
         });

      // ===================
      // 4. STAGGER CARDS
      // ===================
      document
         .querySelectorAll<HTMLElement>("[data-animate='stagger-container']")
         .forEach((container) => {
            const items = container.querySelectorAll<HTMLElement>(
               "[data-animate='stagger-item']"
            );

            items.forEach((item, index) => {
               const staggerDelay = index * 0.08;

               scroll(
                  animate(
                     item,
                     { opacity: [0, 1], y: [40, 0] },
                     { ease: easeExpoOut }
                  ),
                  {
                     target: container,
                     offset: [
                        `start ${0.85 - staggerDelay}`,
                        `start ${0.4 - staggerDelay}`,
                     ],
                  }
               );
            });
         });

      // ===================
      // 5. SCALE UP ON SCROLL
      // ===================
      document
         .querySelectorAll<HTMLElement>("[data-animate='scale-up']")
         .forEach((element) => {
            scroll(
               animate(
                  element,
                  { opacity: [0, 1], scale: [0.9, 1] },
                  { ease: easeExpoOut }
               ),
               {
                  target: element,
                  offset: ["start 0.85", "start 0.4"],
               }
            );
         });
   </script>
</html>

<style>
   html,
   body {
      margin: 0;
      width: 100%;
      height: 100%;
   }
   .main-content {
      position: relative;
      z-index: 10;
      background: var(--background);
   }
</style>
